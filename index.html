<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Shomex Premium</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="style.css">

<!-- PDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>

<section class="banner">
  <img src="KEDAI.png">
</section>

<section class="container">

<div class="app-card">
  <img src="logo.png">
  <h2>KINGTV</h2>
  <a href="https://cutt.ly/king100" class="btn">Download 1</a>
  <a href="https://tinyurl.com/kingtv22" class="btn outline">Download 2</a>
  <button class="btn package-btn" onclick="openPackage('KINGTV')">ðŸ“¦ View Packages</button>
</div>

<div class="app-card">
  <img src="logo2.png">
  <h2>SYOKTV</h2>
  <a href="https://cutt.ly/shosyok" class="btn">Download 1</a>
  <a href="https://tinyurl.com/syoktv2" class="btn outline">Download 2</a>
  <button class="btn package-btn" onclick="openPackage('SYOKTV')">ðŸ“¦ View Packages</button>
</div>

</section>

<section class="payment">
  <h2>Payment Method</h2>
  <a href="https://wasep.me/shomexshop" class="btn buy-btn">ðŸ’³ Online Transfer</a>
  <button class="btn buy-btn" onclick="openQR()">ðŸ“± QR Pay</button>
</section>

<footer>Â© 2025 SHOMEX SHOP</footer>

<!-- PACKAGE MODAL -->
<div class="modal" id="packageModal">
  <div class="modal-box">
    <h2 id="appTitle"></h2>
    <ul id="priceList"></ul>
    <button onclick="closePackage()">Close</button>
  </div>
</div>

<!-- QR MODAL -->
<div class="modal" id="qrModal">
  <div class="modal-box">
    <h3>Scan QR</h3>
    <img src="QRpay.jpg" class="qr-img no-save" draggable="false">

    <input type="file" id="proof" accept="image/*">
    <button onclick="sendWhatsApp()">ðŸ“² Send Proof WhatsApp</button>
    <button onclick="closeQR()">Done</button>
  </div>
</div>

<script>
/* ADMIN PRICE JSON */
const prices = {
  KINGTV: [
    { months: 1, price: 30 },
    { months: 3, price: 80 },
    { months: 6, price: 150 }
  ],
  SYOKTV: [
    { months: 1, price: 28 },
    { months: 3, price: 75 }
  ]
};

let selected = {};

function openPackage(app){
  selected.app = app;
  document.getElementById("packageModal").style.display="flex";
  document.getElementById("appTitle").innerText = app + " Packages";
  const list = document.getElementById("priceList");
  list.innerHTML = "";

  prices[app].forEach(p=>{
    const expiry = calcExpiry(p.months);
    const li = document.createElement("li");
    li.innerHTML = `
      ${p.months} Month - RM${p.price}<br>
      Expiry: ${expiry}<br>
      <button class="btn buy-btn"
        onclick="selectPackage(${p.months},${p.price},'${expiry}')">
        Select
      </button>`;
    list.appendChild(li);
  });
}

function selectPackage(m,p,e){
  selected.months=m; selected.price=p; selected.expiry=e;
  closePackage(); openQR();
}

function calcExpiry(months){
  const d = new Date();
  d.setMonth(d.getMonth()+months);
  return d.toLocaleDateString();
}

function openQR(){ document.getElementById("qrModal").style.display="flex"; }
function closeQR(){ document.getElementById("qrModal").style.display="none"; }
function closePackage(){ document.getElementById("packageModal").style.display="none"; }

function sendWhatsApp(){
  const msg =
`Hi, I have paid.

App: ${selected.app}
Package: ${selected.months} Month
Price: RM${selected.price}
Expiry: ${selected.expiry}`;
  window.open("https://wa.me/601159635600?text="+encodeURIComponent(msg));
  generateInvoice();
}

/* PDF INVOICE */
function generateInvoice(){
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();
  doc.text("SHOMEX INVOICE",20,20);
  doc.text(`App: ${selected.app}`,20,40);
  doc.text(`Package: ${selected.months} Month`,20,50);
  doc.text(`Price: RM${selected.price}`,20,60);
  doc.text(`Expiry: ${selected.expiry}`,20,70);
  doc.save("invoice.pdf");
}
</script>

</body>
</html>
